@model IEnumerable<IGrouping<Department,SalesRecord>>
@{
	ViewData["Title"] = "Grouping Search";
	DateTime minDate = Convert.ToDateTime( ViewData["minDate"]);
	DateTime maxDate = Convert.ToDateTime(ViewData["maxDate"]);
}	
<h2>@ViewData["Title"]</h2>

<nav class="navbar navbar-dark">
	<div class="container-fluid">
		<form class="d-flex" asp-action="SimpleSearch">
			<div class="form-control">
				<label for="minDate">Min Date</label>
				<input class="form-control me-2" type="date" name="minDate" value="@ViewData["minDate"]" />
			</div>
			<div class="form-control">
				<label for="minDate">Min Date</label>
				<input class="form-control me-2" type="date" name="maxDate" value="@ViewData["maxDate"]" />
			</div>
			<button class="btn btn-primary" type="submit">Search</button>
		</form>
	</div>
</nav>
@foreach (var dep in Model)
{
	<div class="bg-primary">
		<div class="card-header">
			<h3 class="card-title">Department: @dep.Key.Name - Total Sales = @dep.Key.TotalSales(minDate,maxDate).ToString("F2")</h3>
		</div>
		<div class="card-body">
			<table class="table table-striped table-hover">
				<thead>
					<tr class="bg-success">
						<th>Date</th>
						<th>Amount</th>
						<th>Seller</th>
						<th>Status</th>
					</tr>
				</thead>
				<tbody>
					@foreach(var item in dep)
					{
						<tr>
							<td>@Html.DisplayFor(x => item.Date)</td>
							<td>@Html.DisplayFor(x => item.Amount)</td>
							<td>@Html.DisplayFor(x => item.Seller.Name)</td>
							<td>@Html.DisplayFor(x => item.Status)</td>
						</tr>
					}
				</tbody>
			</table>
		</div>
	</div>
}